<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 620 280">
  <defs>
    <style>
      .label { font: 500 10px 'SF Mono', 'Menlo', 'Monaco', monospace; fill: #666; text-anchor: middle; letter-spacing: 0.5px; }
      .box-text { font: 600 13px 'SF Mono', 'Menlo', 'Monaco', monospace; fill: #1a1a1a; text-anchor: middle; }
      .title { font: 600 12px 'SF Mono', 'Menlo', 'Monaco', monospace; fill: #1a1a1a; letter-spacing: 1px; }
      .section-title { font: 700 11px 'SF Mono', 'Menlo', 'Monaco', monospace; fill: #1a1a1a; text-anchor: middle; }
      .count { font: 500 9px 'SF Mono', 'Menlo', 'Monaco', monospace; fill: #666; text-anchor: middle; }
      .desc { font: 400 9px 'SF Mono', 'Menlo', 'Monaco', monospace; fill: #666; text-anchor: middle; }
    </style>
    <marker id="arrow-compress" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#666"/>
    </marker>
    <!-- Patterns -->
    <pattern id="dots-full" width="4" height="4" patternUnits="userSpaceOnUse">
      <circle cx="2" cy="2" r="0.6" fill="#94a3b8" opacity="0.5"/>
    </pattern>
  </defs>

  <!-- White background -->
  <rect width="620" height="280" fill="#fff"/>

  <!-- Title -->
  <text x="310" y="28" class="title" text-anchor="middle">THREE-PART RETENTION STRATEGY</text>
  <text x="310" y="44" class="label">三段式保留策略</text>

  <!-- Original full history (top) -->
  <rect x="60" y="65" width="500" height="50" fill="#f1f5f9" stroke="#1a1a1a" stroke-width="1.5"/>
  <rect x="60" y="65" width="500" height="50" fill="url(#dots-full)"/>
  <text x="310" y="90" class="box-text">完整对话历史</text>
  <text x="310" y="105" class="count">(500 条消息)</text>

  <!-- Compression arrow -->
  <line x1="310" y1="115" x2="310" y2="145" stroke="#666" stroke-width="1.5" marker-end="url(#arrow-compress)"/>
  <text x="345" y="135" class="label" text-anchor="start" style="fill: #dc2626;">压缩 COMPRESS</text>

  <!-- Three-part result (bottom) -->
  <g transform="translate(60, 160)">
    <!-- Primers section (purple) -->
    <rect x="0" y="0" width="100" height="80" fill="#ede9fe" stroke="#1a1a1a" stroke-width="1.5"/>
    <text x="50" y="25" class="section-title">Primers</text>
    <text x="50" y="42" class="count">(3 条)</text>
    <line x1="10" y1="52" x2="90" y2="52" stroke="#c4b5fd" stroke-width="1"/>
    <text x="50" y="68" class="desc">初始需求</text>

    <!-- Summary section (cyan) - largest -->
    <rect x="100" y="0" width="300" height="80" fill="#cffafe" stroke="#1a1a1a" stroke-width="1.5"/>
    <text x="250" y="25" class="section-title">Summary</text>
    <text x="250" y="42" class="count">(中间 497 条的语义摘要)</text>
    <line x1="110" y1="52" x2="390" y2="52" stroke="#67e8f9" stroke-width="1"/>
    <text x="250" y="68" class="desc">关键决策、实体、未解决问题</text>

    <!-- Recents section (green) -->
    <rect x="400" y="0" width="100" height="80" fill="#d1fae5" stroke="#1a1a1a" stroke-width="1.5"/>
    <text x="450" y="25" class="section-title">Recents</text>
    <text x="450" y="42" class="count">(20 条)</text>
    <line x1="410" y1="52" x2="490" y2="52" stroke="#6ee7b7" stroke-width="1"/>
    <text x="450" y="68" class="desc">最近交互</text>
  </g>

  <!-- Annotations below -->
  <g transform="translate(60, 255)">
    <text x="50" y="0" class="desc" style="fill: #7c3aed;">保留上下文背景</text>
    <text x="250" y="0" class="desc" style="fill: #0891b2;">LLM 压缩摘要</text>
    <text x="450" y="0" class="desc" style="fill: #059669;">保持连贯性</text>
  </g>
</svg>
