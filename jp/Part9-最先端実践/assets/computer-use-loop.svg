<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 720 480">
  <defs>
    <style>
      .label { font: 500 10px 'SF Mono', 'Menlo', 'Monaco', monospace; fill: #666; text-anchor: middle; letter-spacing: 0.5px; }
      .box-text { font: 600 12px 'SF Mono', 'Menlo', 'Monaco', monospace; fill: #1a1a1a; text-anchor: middle; }
      .title { font: 700 14px 'SF Mono', 'Menlo', 'Monaco', monospace; fill: #1a1a1a; text-anchor: middle; letter-spacing: 1px; }
      .phase-label { font: 700 11px 'SF Mono', 'Menlo', 'Monaco', monospace; fill: #fff; text-anchor: middle; }
      .annotation { font: 400 9px 'SF Mono', 'Menlo', 'Monaco', monospace; fill: #666; }
      .detail { font: 400 9px 'SF Mono', 'Menlo', 'Monaco', monospace; fill: #1a1a1a; }
    </style>
    <marker id="arrow-main" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#4f46e5"/>
    </marker>
    <marker id="arrow-loop" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#f59e0b"/>
    </marker>
    <!-- Gradient for agent box -->
    <linearGradient id="agent-grad" x1="0%" y1="0%" x2="100%" y2="0%">
      <stop offset="0%" style="stop-color:#dbeafe"/>
      <stop offset="50%" style="stop-color:#a5f3fc"/>
      <stop offset="100%" style="stop-color:#d1fae5"/>
    </linearGradient>
  </defs>

  <!-- Background -->
  <rect width="720" height="480" fill="#fff"/>

  <!-- Title -->
  <text x="360" y="28" class="title">COMPUTER USE AGENT LOOP</text>
  <text x="360" y="45" class="label">知覚-判断-実行ループ</text>

  <!-- Main Agent Box -->
  <rect x="60" y="65" width="600" height="220" fill="#f8fafc" stroke="#e2e8f0" stroke-width="2" rx="8"/>
  <text x="360" y="85" class="box-text" style="font-size: 13px;">Computer Use Agent</text>

  <!-- Three Phase Circles -->
  <!-- Phase 1: Perceive -->
  <g transform="translate(160, 170)">
    <circle cx="0" cy="0" r="55" fill="#dbeafe" stroke="#3b82f6" stroke-width="2"/>
    <circle cx="0" cy="-15" r="22" fill="#3b82f6"/>
    <text x="0" y="-10" class="phase-label">1</text>
    <text x="0" y="15" class="box-text" style="fill: #1e40af;">知覚層</text>
    <text x="0" y="30" class="label" style="fill: #3b82f6;">PERCEIVE</text>

    <!-- Details below -->
    <text x="0" y="70" class="detail">スクリーンショット/OCR</text>
    <text x="0" y="82" class="detail">要素識別</text>
    <text x="0" y="94" class="detail">状態理解</text>
  </g>

  <!-- Arrow 1->2 -->
  <line x1="220" y1="170" x2="280" y2="170" stroke="#4f46e5" stroke-width="2" marker-end="url(#arrow-main)"/>

  <!-- Phase 2: Decide -->
  <g transform="translate(360, 170)">
    <circle cx="0" cy="0" r="55" fill="#a5f3fc" stroke="#0891b2" stroke-width="2"/>
    <circle cx="0" cy="-15" r="22" fill="#0891b2"/>
    <text x="0" y="-10" class="phase-label">2</text>
    <text x="0" y="15" class="box-text" style="fill: #0e7490;">判断層</text>
    <text x="0" y="30" class="label" style="fill: #0891b2;">DECIDE</text>

    <!-- Details below -->
    <text x="0" y="70" class="detail">計画/推論</text>
    <text x="0" y="82" class="detail">座標計算</text>
    <text x="0" y="94" class="detail">エラー処理</text>
  </g>

  <!-- Arrow 2->3 -->
  <line x1="420" y1="170" x2="480" y2="170" stroke="#4f46e5" stroke-width="2" marker-end="url(#arrow-main)"/>

  <!-- Phase 3: Execute -->
  <g transform="translate(560, 170)">
    <circle cx="0" cy="0" r="55" fill="#d1fae5" stroke="#10b981" stroke-width="2"/>
    <circle cx="0" cy="-15" r="22" fill="#10b981"/>
    <text x="0" y="-10" class="phase-label">3</text>
    <text x="0" y="15" class="box-text" style="fill: #047857;">実行層</text>
    <text x="0" y="30" class="label" style="fill: #10b981;">EXECUTE</text>

    <!-- Details below -->
    <text x="0" y="70" class="detail">クリック/入力</text>
    <text x="0" y="82" class="detail">キーボード/マウス</text>
    <text x="0" y="94" class="detail">結果検証</text>
  </g>

  <!-- Loop back arrow -->
  <path d="M 560 115 Q 560 55 360 55 Q 160 55 160 115"
        fill="none" stroke="#f59e0b" stroke-width="2" stroke-dasharray="6,3" marker-end="url(#arrow-loop)"/>
  <text x="360" y="48" class="annotation" style="fill: #f59e0b; font-weight: 600;">ループ継続</text>

  <!-- Browser/Desktop Layer -->
  <rect x="60" y="330" width="600" height="120" fill="#1e293b" stroke="#334155" stroke-width="2" rx="8"/>
  <text x="360" y="355" class="box-text" style="fill: #e2e8f0;">ブラウザ/デスクトップ環境</text>

  <!-- Environment boxes -->
  <g transform="translate(100, 375)">
    <rect x="0" y="0" width="100" height="55" fill="#334155" stroke="#475569" stroke-width="1" rx="4"/>
    <text x="50" y="25" class="label" style="fill: #94a3b8;">Browser</text>
    <text x="50" y="42" class="annotation" style="fill: #64748b;">ブラウザ</text>
  </g>
  <g transform="translate(220, 375)">
    <rect x="0" y="0" width="100" height="55" fill="#334155" stroke="#475569" stroke-width="1" rx="4"/>
    <text x="50" y="25" class="label" style="fill: #94a3b8;">Desktop</text>
    <text x="50" y="42" class="annotation" style="fill: #64748b;">デスクトップ</text>
  </g>
  <g transform="translate(340, 375)">
    <rect x="0" y="0" width="100" height="55" fill="#334155" stroke="#475569" stroke-width="1" rx="4"/>
    <text x="50" y="25" class="label" style="fill: #94a3b8;">Terminal</text>
    <text x="50" y="42" class="annotation" style="fill: #64748b;">ターミナル</text>
  </g>
  <g transform="translate(460, 375)">
    <rect x="0" y="0" width="100" height="55" fill="#334155" stroke="#475569" stroke-width="1" rx="4"/>
    <text x="50" y="25" class="label" style="fill: #94a3b8;">Apps</text>
    <text x="50" y="42" class="annotation" style="fill: #64748b;">アプリ</text>
  </g>

  <!-- Connection arrow from agent to environment -->
  <line x1="360" y1="285" x2="360" y2="325" stroke="#4f46e5" stroke-width="2" marker-end="url(#arrow-main)"/>
</svg>
