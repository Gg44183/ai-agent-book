# 『AIエージェントアーキテクチャ：単体からエンタープライズ級マルチエージェントへ』

> **概念から本番環境まで：フレームワーク非依存のAIエージェント設計パターンと実践ガイド**

[![Shannon OSS](https://img.shields.io/badge/参考実装-Shannon%20OSS-blue)](https://github.com/Kocoro-lab/Shannon)
[![License: CC BY-NC-SA 4.0](https://img.shields.io/badge/License-CC%20BY--NC--SA%204.0-lightgrey.svg)](https://creativecommons.org/licenses/by-nc-sa/4.0/)

**著者**: [Wayland Zhang](https://waylandz.com)

---

## 本書の内容

![単体Agentからエンタープライズ級マルチエージェントシステムへ](assets/book-overview-hero.svg)

**フレームワークのドキュメントではなく、エージェントシステムの設計パターンを理解するための実践ガイドです。**

世の中のエージェント系チュートリアルの多くは以下のレベルに留まっています：
- APIを呼び出してチャットボットデモを作る
- 特定フレームワークの設定説明とAPI翻訳
- プロンプトテクニックの羅列

これらでは「使う」ことはできても、本番環境で動くエージェントシステムを「構築する」ことはできません。

本当の本番システムには以下の疑問への答えが必要です：
- **複数エージェントをどう連携させる？** DAG、Supervisor、それともHandoff？
- **トークン予算をどう管理する？** 1回の呼び出し単位か、ワークフロー全体か？
- **ツール実行が失敗したらどうする？** リトライ、フォールバック、それとも人的介入？
- **セキュリティはどう担保する？** サンドボックス隔離、権限管理、監査ログ

本書はこれらの疑問に答え、オープンソースプロジェクト[Shannon](https://github.com/Kocoro-lab/Shannon)で完全なコード参照を提供します。

---

## 対象読者

| 読者タイプ | 得られるもの |
|-----------|-------------|
| **バックエンドエンジニア** | ゼロからエージェントシステムを構築する完全な道筋 |
| **アーキテクト** | マルチエージェント編成、エンタープライズガバナンスの設計パターン |
| **技術責任者** | エージェント導入の評価と実装のための意思決定フレームワーク |

### 前提知識

- **必須**：基本的なプログラミング能力（Go/Python/Rustのいずれか）
- **必須**：LLMの基本概念（Token、Prompt、Temperatureなど）
- **あると良い**：REST/gRPC APIの理解
- **不要**：特定のエージェントフレームワークの知識

### 向いていない可能性がある方

- ChatGPT APIを手軽に呼び出したいだけの方（公式ドキュメントを参照してください）
- プロンプトエンジニアリングのテクニック集を探している方（専門の資料があります）
- LLMの基本概念に触れたことがない方（まず基礎を学ぶことをお勧めします）

---

## 本書の構成

全**9パート、30章**で構成されています：

| パート | テーマ | 主な内容 |
|--------|--------|----------|
| **Part 1** | エージェント基礎 | エージェントの本質、ReActループ |
| **Part 2** | ツールと拡張 | Function Calling、MCP、Skills、Hooks |
| **Part 3** | コンテキストとメモリ | Context管理、Memoryアーキテクチャ、セッション設計 |
| **Part 4** | 単一エージェントパターン | Planning、Reflection、Chain-of-Thought |
| **Part 5** | マルチエージェント編成 | DAG、Supervisor、Handoff |
| **Part 6** | 高度な推論 | Tree-of-Thoughts、Debate、Research |
| **Part 7** | 本番アーキテクチャ | 3層設計、Temporal、オブザーバビリティ |
| **Part 8** | エンタープライズ機能 | トークン予算、OPAポリシー、WASIサンドボックス、マルチテナント |
| **Part 9** | 最先端実践 | Computer Use、Agentic Coding、Background Agents |

```
Part1-エージェント基礎/      エージェント概念、ReActループ
Part2-ツールと拡張/          Tools、MCP、Skills、Hooks
Part3-コンテキストとメモリ/  Context管理、Memoryアーキテクチャ
Part4-単一エージェントパターン/ Planning、Reflection、CoT
Part5-マルチエージェント編成/   DAG、Supervisor、Handoff
Part6-高度な推論/            ToT、Debate、Research
Part7-本番アーキテクチャ/    3層設計、Temporal、オブザーバビリティ
Part8-エンタープライズ機能/  予算管理、OPA、WASIサンドボックス
Part9-最先端実践/            Computer Use、Agentic Coding
付録/                        ケーススタディ、テンプレート、フレームワーク比較
```

---

## 参考実装：Shannon

本書は[Shannon](https://github.com/Kocoro-lab/Shannon)を参考実装として使用します。Shannonは3層アーキテクチャのマルチエージェントシステムです：

```
Orchestrator (Go)    - 編成、予算管理、ポリシー
Agent Core (Rust)    - 実行、サンドボックス、レート制限
LLM Service (Python) - 推論、ツール、ベクトル検索
```

Shannonは唯一の選択肢ではありません。LangGraph、CrewAI、AutoGenでも同様のことができます。本書の目的は**設計パターン**を教えることであり、Shannonの使い方を教えることではありません。

---

## 執筆理念

**パターンが先、フレームワークは後。**

フレームワークは廃れますが、パターンは廃れません。各章は以下の構成に従っています：

1. **まず問題を提示する** ── どんな場面でこの機能が必要になるか？
2. **次にパターンを解説する** ── 汎用的な設計パターンは何か？（フレームワーク非依存）
3. **そして実装を見せる** ── Shannonを例に一つの実装方法を示す
4. **最後に比較する** ── 他のフレームワークは同じ問題をどう解決しているか

各章を読み終えたとき、どんなフレームワークでも同じパターンを実装できるようになっていれば──その章は成功です。

---

## 読書ガイド

### クイックスタート（2〜3日）
```
Part1 全体 → 第03章 → 第13章 → 第20章
```
目標：エージェント基礎 → ツール呼び出し → マルチエージェント編成 → 本番アーキテクチャを理解する

### 体系的な学習（2〜3週間）
```
Part1〜8を順番に読み、Shannonのコードと照らし合わせる
```
目標：単一エージェントからエンタープライズ級マルチエージェントまでの全体像を習得する

### 最新トレンド（1〜2日）
```
第04章(MCP) → 第27章(Computer Use) → 第28章(Agentic Coding)
```
目標：2025〜2026年で最もホットなエージェント関連トピックを把握する

---

## 一貫した実践プロジェクト

> **プロジェクト：インテリジェント・リサーチアシスタント（Research エージェント）**

Part1からPart9まで、完全なリサーチアシスタントエージェントを段階的に構築していきます：

| パート | プロジェクトの進化 | 能力の向上 |
|--------|-------------------|-----------|
| Part 1 | シンプルなQ&Aエージェント | 基本的なReActループ |
| Part 2 | + ツール呼び出し | 検索、ファイル読み取り |
| Part 3 | + メモリシステム | 複数ターン対話、履歴呼び出し |
| Part 4 | + 自律的計画 | タスク分解、反省による改善 |
| Part 5 | + マルチエージェント協調 | 検索 + 分析 + 執筆エージェント |
| Part 6 | + 高度な推論 | 複数ソース比較、議論による統合 |
| Part 7 | + 本番アーキテクチャ | Temporal永続化、オブザーバビリティ |
| Part 8 | + エンタープライズガバナンス | トークン予算、権限管理 |
| Part 9 | + 最先端機能 | ブラウザ操作、コード生成 |

---

## 情報の鮮度について

AIエージェント分野は極めて速いペースで進化しています。本書では、変化が激しい内容には明確に注記しています：

> **【鮮度注意】** (2026-01): 本節の内容はMCP仕様v1.0に基づいています。

核心的なアーキテクチャパターンは比較的安定していますが、具体的なAPIやツールは変わる可能性があります。疑問があれば、公式ドキュメントを参照してください。

---

## クイックナビゲーション

| リンク | 説明 |
|--------|------|
| [はじめに](./はじめに.md) | 執筆の動機、執筆理念、対象読者 |
| [目次](./目次.md) | 全30章の完全な目次と学習パス |
| [第1章：エージェントの本質](./Part1-エージェント基礎/第01章：エージェントの本質.md) | 読み始める |
| [Shannon OSS](https://github.com/Kocoro-lab/Shannon) | 参考実装コード |

---

## ライセンス

本書のコンテンツは[CC BY-NC-SA 4.0](https://creativecommons.org/licenses/by-nc-sa/4.0/)ライセンスの下で公開されています。

付随コードのShannon OSSは[Apache 2.0](https://github.com/Kocoro-lab/Shannon/blob/main/LICENSE)ライセンスの下で公開されています。

---

> *"The best way to learn is to build."*
